<!DOCTYPE html>

<html lang="zh-TW">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->


    <link rel="dns-prefetch" href="//disqus.com">
    <link rel="dns-prefetch" href="//mosdeo-github-io.disqus.com">






<!-- analytics -->


    <link rel="dns-prefetch" href="//www.google-analytics.com">






    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法 | LKY 只有原創內容的 Blog</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/img/suka-favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/css/highlight/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="LKY 只有原創內容的 Blog"><meta name="msapplication-starturl" content="https://mosdeo.github.io"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="LKY 只有原創內容的 Blog"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法 | LKY 只有原創內容的 Blog"><meta property="og:site_name" content="LKY 只有原創內容的 Blog"><meta property="og:type" content="article"><meta property="og:url" content="https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/"><meta property="og:locale" content="zh-TW"><meta name="description" content="前言：由於 LeetCode Concurrency(併發) 還沒有 Go 語言版本，我先自行用 Go 語言來解題。為了能在 LeetCode 以外的平台獲得討論，所以我打算逐漸把自己的解題思路寫下。 本題 LeetCode 連結： https:&#x2F;&#x2F;leetcode.com&#x2F;problems&#x2F;the-dining-philosophers&#x2F; 本題題目  「哲學家吃飯問題」是一個作業系統中的經典問題 - Lin, Kao-Yuan - LKY 只有原創內容的 Blog"><meta name="keywords" content="Go語言"><meta property="og:image" content="/content/images/leetcode/LeetCodeIcon_890x501.JPG"><meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/An_illustration_of_the_dining_philosophers_problem.png/400px-An_illustration_of_the_dining_philosophers_problem.png"><meta property="og:image" content="https://mosdeo.github.io/content/images/leetcode/DiningPhilosophersProblem%E7%A4%BA%E6%84%8F%E5%9C%9620200902.PNG"><meta property="article:published_time" content="2020-09-01T16:00:00.000Z"><meta property="article:modified_time" content="2020-09-02T13:50:51.000Z"><meta property="og:updated_time" content="2020-09-02T13:50:51.000Z"><meta property="article:author" content="Lin, Kao-Yuan"><meta property="article:tag" content="Go語言"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="/content/images/leetcode/LeetCodeIcon_890x501.JPG">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/">

    <meta name="generator" content="Hexo 5.2.0">

    <!-- ### Analytics ### -->
    
    <!-- Google Analytics -->
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-64570213-2', 'auto');
    ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>









    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/",
    "@type": "BlogPosting",
    "logo": "https://mosdeo.github.io/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/"
    },
    "headline": "LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法 | LKY 只有原創內容的 Blog",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://mosdeo.github.io/content/images/leetcode/LeetCodeIcon_890x501.JPG"
    },
    
    "datePublished": "2020-09-01T16:00:00.000Z",
    "dateModified": "2020-09-02T13:50:51.000Z",
    "author": {
        "@type": "Person",
        "name": "Lin, Kao-Yuan",
        "image": {
            "@type": "ImageObject",
            "url": "https://mosdeo.github.io/img/default_avatar.png"
        },
        "description": "今之能者，謂能轉貼，至於魯蛇，皆能轉貼。不原創，何以別乎？"
    },
    "publisher": {
        "@type": "Organization",
        "name": "LKY 只有原創內容的 Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://mosdeo.github.io/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://mosdeo.github.io/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "Go語言",
    "description": "前言：由於 LeetCode Concurrency(併發) 還沒有 Go 語言版本，我先自行用 Go 語言來解題。為了能在 LeetCode 以外的平台獲得討論，所以我打算逐漸把自己的解題思路寫下。 本題 LeetCode 連結： https://leetcode.com/problems/the-dining-philosophers/ 本題題目  「哲學家吃飯問題」是一個作業系統中的經典問題 - Lin, Kao-Yuan - LKY 只有原創內容的 Blog"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">LKY 只有原創內容的 Blog</a></h1>

    <p class="text-center header-slogan">
        
            
                今之能者，謂能轉貼，至於魯蛇，皆能轉貼。不原創，何以別乎？
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">首页</a>
    
    
        <a href="/archives/" class="navbar-link">归档</a>
    
    
        <a href="/search" class="navbar-link">搜索</a>
    
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">分享</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=LKY 只有原創內容的 Blog&url=https://mosdeo.github.io&pic=/content/images/leetcode/LeetCodeIcon_890x501.JPG&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=LKY 只有原創內容的 Blog&url=https://mosdeo.github.io&via=Lin, Kao-Yuan" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://mosdeo.github.io" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=https://mosdeo.github.io" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://mosdeo.github.io&title=LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=LKY 只有原創內容的 Blog&title=LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法&summary=&pics=/content/images/leetcode/LeetCodeIcon_890x501.JPG&url=https://mosdeo.github.io" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=https://mosdeo.github.io&text=LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAAAAADrYxXWAAAFXElEQVR42u2dQW7jMBAE/f9PK6cAgSFOV5O67Kp0ySaWTLIWaMz0dJzP5XV9RCAEIQhBCEIQwgjhM1y/r/+99+7f3z/7fu3753/f//u+9Npqze970rmEIAQhrCHcigZ8s2mRu9dXB0iHXv2n3O2FnEsIQhDCDIEK4gSGiudq07fiBaBP+xj3JwQhCKGGkBZIxdL03CSkrYCmNYQgBCE8K4wrQZuKFCpmqVgiUKbiSghCEEIPYWo0JhODbKwpvJr1ksA+1kUKQQgvg0AbkX/t6+NusxCE8AIIcWgJCpvm2UnACHxaCD06lRaCEF4EIZmexPwgg5lJiCmM6bBTUbZs/IQgBCGMxVISOQKgNVGSWdOEOsggJwa3hCAEIeCQFjE+dk1aCooUVlRQhSAEIdw3UGkIQoNTqWghhuwU1qJFVnoPIQhBCJ84d2gMEXJwasJQwWuGO9MwRghCEEIPgRZEyXihRc0JQDLMXRaBQhCCEMaQRjI36GZoY9MUTKl4IucZu0ghCEEI44GISdKIHjFKiMmTBHAMZdCQhhCE8HIIp4I0LUSKIhoK3xnWTqIuBCEIoZs7EFOFGq+tmUrNmCR+42BZCEIQwrJYaoYYZLiaGqx2aEKHMFRAhSAEIcy9AymaSDiqaYJIAdUMeqj4CkEIQuAQaFPVFi3J9GxMHnpNRowQhCCECwsjMUOomdI2QOQ+8mwa1gpBCEK4xoEs+doMWNAmwCAn3XMCTAhCEMIc0qDDDWqqUOFshqxkODQBFoIQhJAhkCAkNUoT1Mk4aYWPBkqXoIQgBCEsIaRQN2mQaOiiCWqQfRJDdzRahSAEIWwdpimaUoNF7qOiTcMaQhCCEDIE0vTENwOhy/R9KpCaoioVa0IQghD4B9ARYzOJYGqQ2jXSgJbuAQ1fhCCEl0MgIpiMi0kQk6naDHfapi8JpxCEIIT9gexkXKw2kwLY6b5m4EL3H4slIQhBCOiP3pEQBFm8LXQIZPr+tTAKQQgvhUDDDckcSeEKekDSMFEwU1MmBCEIoRPG1DTRhoY8nwYoO4ZvNZUWghCEgIuOxmydmqR0+F2YyaBdmrZCEIIQbo3WpvhpDpk2Na1Lw15JoMezCUEIQqiCW6RhacQwHboNcE1hEFIwCUEIQuAQSCirLahOBJGYKamxq4VRCEJ4IQQawExiRxqpJphBzJuTZ4UgBCGc5xNIQUIbmtRQEeFLAhxFXwhCEMLSVElmZ2ts0GaLhLGaBiuZMKPRKgQhCAEbrTSE0TRm5HCTkUJCY6hYEoIQhFA3UDvGaCOazRA3DXKnvQtBCEL4xLkDOSgRQ1L8kMLmicFL7TYLQQhCGJun0yaGFEjECKFFVLumEIQghGvpJ9QGZTGMpaENCoo0eOksQhCCELIw0kNQcUubPgl6k4HxZL4IQQhCyL8IRgUuiWYjlGlIe2LwbIU0hCAEIVQfFHUiUs1whA5XiBCigLcQhCCE+oNqyWLNMPckjEGC3yjAIQQhCCGaKim8RYSHhjdOmh9i8sZBsBCEIIRKGHdMV9LQTI1RasIIUBwWE4IQhBAHsu0whpiiyUxNhVazFjFrhSAEIeSB7HRYUtSkhonck8wXsi5t2oQgBCFkj5EEIk9CFcQoSYbLjhmLhy9CEIIQYuORCqY09JwKsgkoKb7o2stnhCAEISwhNAYHGYaQzZKLmjGkgRKCEIRwDiEVUcQYbZquFN5qQhqxCROCEISwDYEMUOiBk2G6I3hTA4eGL0IQghCqQSYJcaVAFzFiUyPXFFlVSEMIQhDCltFKhIsEuUgwjIYwSFjrUbdZCEL4jyG8+RKCEIQgBCEIQQi31w/z1GO9FHdo8AAAAABJRU5ErkJggg==" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
        <a href="/atom.xml" target="_blank" class="navbar-link">RSS</a>
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
            <div class="card-image lazyload" data-bg="url('/content/images/leetcode/LeetCodeIcon_890x501.JPG')"></div>
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="Lin, Kao-Yuan's Avatar">
        <span>2020-09-02</span>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">分享本文</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法&url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/&pic=/content/images/leetcode/LeetCodeIcon_890x501.JPG&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=LeetCode Concurrency Go 語言詳解：經典哲學家吃飯問題：碰運氣解法&url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/&via=Lin, Kao-Yuan" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/&title=LKY 只有原創內容的 Blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=LKY 只有原創內容的 Blog&title=LKY 只有原創內容的 Blog&summary=&pics=/content/images/leetcode/LeetCodeIcon_890x501.JPG&url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/&text=LKY 只有原創內容的 Blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAAAAADrYxXWAAAFXElEQVR42u2dQW7jMBAE/f9PK6cAgSFOV5O67Kp0ySaWTLIWaMz0dJzP5XV9RCAEIQhBCEIQwgjhM1y/r/+99+7f3z/7fu3753/f//u+9Npqze970rmEIAQhrCHcigZ8s2mRu9dXB0iHXv2n3O2FnEsIQhDCDIEK4gSGiudq07fiBaBP+xj3JwQhCKGGkBZIxdL03CSkrYCmNYQgBCE8K4wrQZuKFCpmqVgiUKbiSghCEEIPYWo0JhODbKwpvJr1ksA+1kUKQQgvg0AbkX/t6+NusxCE8AIIcWgJCpvm2UnACHxaCD06lRaCEF4EIZmexPwgg5lJiCmM6bBTUbZs/IQgBCGMxVISOQKgNVGSWdOEOsggJwa3hCAEIeCQFjE+dk1aCooUVlRQhSAEIdw3UGkIQoNTqWghhuwU1qJFVnoPIQhBCJ84d2gMEXJwasJQwWuGO9MwRghCEEIPgRZEyXihRc0JQDLMXRaBQhCCEMaQRjI36GZoY9MUTKl4IucZu0ghCEEI44GISdKIHjFKiMmTBHAMZdCQhhCE8HIIp4I0LUSKIhoK3xnWTqIuBCEIoZs7EFOFGq+tmUrNmCR+42BZCEIQwrJYaoYYZLiaGqx2aEKHMFRAhSAEIcy9AymaSDiqaYJIAdUMeqj4CkEIQuAQaFPVFi3J9GxMHnpNRowQhCCECwsjMUOomdI2QOQ+8mwa1gpBCEK4xoEs+doMWNAmwCAn3XMCTAhCEMIc0qDDDWqqUOFshqxkODQBFoIQhJAhkCAkNUoT1Mk4aYWPBkqXoIQgBCEsIaRQN2mQaOiiCWqQfRJDdzRahSAEIWwdpimaUoNF7qOiTcMaQhCCEDIE0vTENwOhy/R9KpCaoioVa0IQghD4B9ARYzOJYGqQ2jXSgJbuAQ1fhCCEl0MgIpiMi0kQk6naDHfapi8JpxCEIIT9gexkXKw2kwLY6b5m4EL3H4slIQhBCOiP3pEQBFm8LXQIZPr+tTAKQQgvhUDDDckcSeEKekDSMFEwU1MmBCEIoRPG1DTRhoY8nwYoO4ZvNZUWghCEgIuOxmydmqR0+F2YyaBdmrZCEIIQbo3WpvhpDpk2Na1Lw15JoMezCUEIQqiCW6RhacQwHboNcE1hEFIwCUEIQuAQSCirLahOBJGYKamxq4VRCEJ4IQQawExiRxqpJphBzJuTZ4UgBCGc5xNIQUIbmtRQEeFLAhxFXwhCEMLSVElmZ2ts0GaLhLGaBiuZMKPRKgQhCAEbrTSE0TRm5HCTkUJCY6hYEoIQhFA3UDvGaCOazRA3DXKnvQtBCEL4xLkDOSgRQ1L8kMLmicFL7TYLQQhCGJun0yaGFEjECKFFVLumEIQghGvpJ9QGZTGMpaENCoo0eOksQhCCELIw0kNQcUubPgl6k4HxZL4IQQhCyL8IRgUuiWYjlGlIe2LwbIU0hCAEIVQfFHUiUs1whA5XiBCigLcQhCCE+oNqyWLNMPckjEGC3yjAIQQhCCGaKim8RYSHhjdOmh9i8sZBsBCEIIRKGHdMV9LQTI1RasIIUBwWE4IQhBAHsu0whpiiyUxNhVazFjFrhSAEIeSB7HRYUtSkhonck8wXsi5t2oQgBCFkj5EEIk9CFcQoSYbLjhmLhy9CEIIQYuORCqY09JwKsgkoKb7o2stnhCAEISwhNAYHGYaQzZKLmjGkgRKCEIRwDiEVUcQYbZquFN5qQhqxCROCEISwDYEMUOiBk2G6I3hTA4eGL0IQghCqQSYJcaVAFzFiUyPXFFlVSEMIQhDCltFKhIsEuUgwjIYwSFjrUbdZCEL4jyG8+RKCEIQgBCEIQQi31w/z1GO9FHdo8AAAAABJRU5ErkJggg==" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9C%AC%E9%A1%8C-LeetCode-%E9%80%A3%E7%B5%90%EF%BC%9A"><span class="post-toc-number">1.</span> <span class="post-toc-text">本題 LeetCode 連結：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9C%AC%E9%A1%8C%E9%A1%8C%E7%9B%AE"><span class="post-toc-number">2.</span> <span class="post-toc-text">本題題目</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%8C%E5%8F%89%E5%AD%90%E3%80%8D%E8%88%87%E3%80%8C%E7%AD%B7%E5%AD%90%E3%80%8D"><span class="post-toc-number">3.</span> <span class="post-toc-text">「叉子」與「筷子」</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9C%AC%E9%A1%8C%E8%80%83%E6%A0%B8%E9%9B%A3%E9%BB%9E%EF%BC%9F%E3%80%8C%E6%8B%BF%E5%BE%97%E8%B5%B7%E6%94%BE%E4%B8%8D%E4%B8%8B%E3%80%8D%E9%80%A0%E6%88%90%E6%AD%BB%E7%B5%90%E3%80%81%E3%80%8C%E7%84%A1%E9%99%90%E8%BC%AA%E8%BF%B4%E3%80%8D%E9%80%A0%E6%88%90%E6%B4%BB%E7%B5%90%E9%A3%A2%E9%A4%93%E8%87%B3%E6%AD%BB"><span class="post-toc-number">4.</span> <span class="post-toc-text">本題考核難點？「拿得起放不下」造成死結、「無限輪迴」造成活結飢餓至死</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%A7%A3%E6%B3%95%E8%88%87%E6%80%9D%E8%B7%AF%EF%BC%9A"><span class="post-toc-number">5.</span> <span class="post-toc-text">解法與思路：</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-%E6%89%80%E7%94%A8-Channel-%E5%9E%8B%E6%85%8B%E8%88%87%E5%AE%9A%E4%BD%8D%EF%BC%9F"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">1. 所用 Channel 型態與定位？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">初始化</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-%E4%BA%94%E5%80%8B-goroutine-%E4%B9%8B%E9%96%93%EF%BC%8C%E5%A6%82%E4%BD%95%E4%BA%A4%E6%8E%A5%E6%A3%92%EF%BC%9F"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">2. 五個 goroutine 之間，如何交接棒？</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%87%AA%E5%BE%AA%E7%92%B0-%E5%A4%96%E9%83%A8%E5%95%9F%E5%8B%95%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85"><span class="post-toc-number">5.3.1.</span> <span class="post-toc-text">自循環 &amp; 外部啟動注意事項</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%AF%A6%E4%BD%9C%E5%89%8D%E8%BF%B0%E7%9A%84%E4%B8%89%E6%A2%9D%E8%A6%8F%E7%AF%84%E7%9A%84-WantToEat"><span class="post-toc-number">5.3.2.</span> <span class="post-toc-text">實作前述的三條規範的 WantToEat()</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AE%8C%E6%95%B4%E8%A7%A3%E9%A1%8C%E7%A8%8B%E5%BC%8F%E7%A2%BC%EF%BC%9A"><span class="post-toc-number">6.</span> <span class="post-toc-text">完整解題程式碼：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%A4%BA%E6%84%8F%E5%9C%96%EF%BC%9A"><span class="post-toc-number">7.</span> <span class="post-toc-text">示意圖：</span></a></li></ol></div>
                        
                    
                    <article id="post-content">
                        <p>前言：由於 LeetCode Concurrency(併發) 還沒有 Go 語言版本，我先自行用 Go 語言來解題。為了能在 LeetCode 以外的平台獲得討論，所以我打算逐漸把自己的解題思路寫下。</p>
<h2 id="本題-LeetCode-連結：">本題 LeetCode 連結：</h2>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/the-dining-philosophers/">https://leetcode.com/problems/the-dining-philosophers/</a></p>
<h2 id="本題題目">本題題目</h2>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/An_illustration_of_the_dining_philosophers_problem.png/400px-An_illustration_of_the_dining_philosophers_problem.png" alt=""></p>
<p>「哲學家吃飯問題」是一個作業系統中的經典問題，所以抽象題幹我就不再贅述，直接說實作要求。</p>
<blockquote>
<p>The philosophers’ ids are numbered from 0 to 4 in a clockwise order. Implement the function void wantsToEat(philosopher, pickLeftFork, pickRightFork, eat, putLeftFork, putRightFork) where:</p>
</blockquote>
<p>有幾位哲學家，他們的 ID 順時針由 0~4，實作一個函數 <code>void wantsToEat(philosopher, pickLeftFork, pickRightFork, eat, putLeftFork, putRightFork)</code>，其中…</p>
<blockquote>
<p>philosopher is the id of the philosopher who wants to eat.</p>
</blockquote>
<p>參數 <code>philosopher</code> 代表想要吃飯的哲學家的 ID。</p>
<blockquote>
<p>pickLeftFork and pickRightFork are functions you can call to pick the corresponding forks of that philosopher.</p>
</blockquote>
<p>參數 <code>pickLeftFork</code> and <code>pickRightFork</code> 是函數，你必須呼叫他們來使哲學家拿起對應的叉子。</p>
<blockquote>
<p>eat is a function you can call to let the philosopher eat once he has picked both forks.</p>
</blockquote>
<p>當哲學家拿起兩隻叉子後，你必須呼叫 <code>eat</code> 這個函數讓哲學家吃一次。</p>
<blockquote>
<p>putLeftFork and pickRightFork are functions you can call to put down the corresponding forks of that philosopher.</p>
</blockquote>
<p>參數 <code>putLeftFork</code> and <code>pickRightFork</code> 是函式，你必須呼叫他們來使哲學家放下手中的叉子。</p>
<blockquote>
<p>The philosophers are assumed to be thinking as long as they are not asking to eat (the function is not being called with their number).</p>
</blockquote>
<p>假設哲學家們都會思考很久，中間都不會要求吃東西（呼叫函式 thinking() 不必使用哲學家們的 ID）</p>
<blockquote>
<p>Five threads, each representing a philosopher, will simultaneously use one object of your class to simulate the process. It is possible that the function will be called for the same philosopher more than once, even before the last call ends.</p>
</blockquote>
<p>五個執行緒，每一個執行緒代表都一個哲學家，用一個類(在 Go 語言是 struct)模擬這個 process。這個函式可能被同一個哲學家呼叫多次，甚至在最後一次呼叫結束前的途中都有可能。</p>
<h2 id="「叉子」與「筷子」">「叉子」與「筷子」</h2>
<p>最早課本裡都是說「叉子」。但我大學上 OS 的時候老師就提過一個疑問：「用叉子吃義大利麵，一隻就夠了，沒必要用到兩隻吧？所以，改成用筷子是不是更合理一點？但沒辦法，誰叫這門學問是西方先發明的？我們就當作筷子吧」。<br>
於是，本文也決定照改，以下都用「筷子」代替「叉子」。</p>
<h2 id="本題考核難點？「拿得起放不下」造成死結、「無限輪迴」造成活結飢餓至死">本題考核難點？「拿得起放不下」造成死結、「無限輪迴」造成活結飢餓至死</h2>
<p>在過去的 LeetCode Concurrency 詳解中，我提到過很多次：</p>
<blockquote>
<p>goroutine 若不刻意控制，將無法保證執行的先後順序，因此本題就是要考核對 goroutine 順序控制的能力。</p>
</blockquote>
<p>但前面幾題的解法，大多是把判斷責任中心化，方便控管順序。這次，與前面幾題不同的是，這一題要求把判斷責任分散到每一位哲學家 thread 身上，哲學家彼此之間並不溝通，因此很容易發生資源互卡，也就是 deadlock。本文所示範的 channel 使用方法已經完全避免了死結(deadlock)。但這樣就沒問題了嗎？不，還有可能發生<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%AD%BB%E9%94%81#%E6%B4%BB%E7%B5%90">活結(livelock)</a>。</p>
<p>這邊我為了示範 goroutine，先用最笨的碰運氣解法，也就是不刻意做任何資源配置，要在運氣很壞的情況下才會遇上 livelock。什麼是「運氣很壞的情況」？就是所有哲學家剛好在同一時間拿起同一邊的叉子。但實作上，由於我給每位哲學家一個隨機的思考時間 50mS（如下列程式碼），碰撞的機會是(1/50)^5，所以絕大部分情況下不會發生 livelock。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Think</span><span class="params">()</span></span> &#123;</span><br><span class="line">	Random := <span class="function"><span class="keyword">func</span><span class="params">(max <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		rand.Seed(time.Now().Unix())</span><br><span class="line">		<span class="keyword">return</span> rand.Int() % (max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	&lt;-time.After(time.Millisecond * time.Duration(Random(<span class="number">50</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Wiki 上有介紹不需要碰運氣，保證不會讓 thread 飢餓致死的演算法，但我自己也沒搞懂，請容我日後再介紹。</p>
<h2 id="解法與思路：">解法與思路：</h2>
<h3 id="1-所用-Channel-型態與定位？">1. 所用 Channel 型態與定位？</h3>
<p>本題採用 5 個 buffered channel，分別代表 5 支筷子</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> DiningPhilosophers <span class="keyword">struct</span> &#123;</span><br><span class="line">	wg                     *sync.WaitGroup</span><br><span class="line">	streamForks            [<span class="number">5</span>]<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	missingDoubleForkTimes <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Channel 初始化</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> diningPhilosophers.streamForks &#123;</span><br><span class="line">	diningPhilosophers.streamForks[i] = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="初始化">初始化</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 叫所有哲學家開始動作</span></span><br><span class="line">start := time.Now()</span><br><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> diningPhilosophers.streamForks &#123;</span><br><span class="line">	diningPhilosophers.wg.Add(<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">go</span> diningPhilosophers.WantToEat(i, PickLeftFork, PickRightFork, Eat, PutLeftFork, PutRightFork)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>這邊開始計時後，是一個 foreach。<br>
老方法，用 <code>sync.WaitGroup</code> 同步 5 個哲學家 goroutine 結束時間。<br>
給每一位哲學家起一個「WantToEat」的 goroutine，告訴他 i 你是幾號？又給入「PickLeftFork, PickRightFork, Eat, PutLeftFork, PutRightFork」五個函式的的 function reference。</p>
<h3 id="2-五個-goroutine-之間，如何交接棒？">2. 五個 goroutine 之間，如何交接棒？</h3>
<p>沒有交接棒問題，每位哲學家就憑運氣去搶左右邊的兩隻筷子。<br>
要注意的只有三件事情：</p>
<ol>
<li>無法同時搶到兩隻筷子的哲學家，必須先放棄到手的一支筷子。</li>
<li>已經同時搶到兩隻筷子的哲學家，吃完就必須退出餐桌。</li>
<li>還沒吃到的哲學家，可以無限次搶。</li>
</ol>
<h4 id="自循環-外部啟動注意事項">自循環 &amp; 外部啟動注意事項</h4>
<p>這次解題沒有實作這些協調機制，5 個 goroutine 只靠前述的三條規範野蠻生長。</p>
<h4 id="實作前述的三條規範的-WantToEat">實作前述的三條規範的 WantToEat()</h4>
<ul>
<li>本質上就是代表「還沒吃到的哲學家，可以無限次搶」的無限迴圈。</li>
<li>「已經同時搶到兩隻筷子的哲學家，吃完就必須退出餐桌」是此迴圈的結束條件。</li>
<li>「無法同時搶到兩隻筷子的哲學家，必須先放棄到手的一支筷子。」是此迴圈其中一個分支。</li>
</ul>
<p>有一行「<code>return //吃飽離開</code>」，整個流程最終目的就是要走到這一行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *DiningPhilosophers)</span> <span class="title">WantToEat</span><span class="params">(philosopher <span class="keyword">int</span>, pickLeftFork <span class="keyword">func</span>(<span class="keyword">int</span>)</span>, <span class="title">pickRightFork</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span>, <span class="title">eat</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span>, <span class="title">putLeftFork</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span>, <span class="title">putRightFork</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span>)</span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> this.wg.Done()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> leftNum = (philosopher + <span class="number">4</span>) % <span class="number">5</span>  <span class="comment">//取得該哲學家左邊的號碼</span></span><br><span class="line">	<span class="keyword">var</span> rightNum = (philosopher + <span class="number">6</span>) % <span class="number">5</span> <span class="comment">//取得該哲學家右邊的號碼</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> this.streamForks[leftNum] &lt;- philosopher: <span class="comment">//嘗試拿起左邊筷子</span></span><br><span class="line">			PickLeftFork(philosopher) <span class="comment">//成功拿起左邊筷子</span></span><br><span class="line">			<span class="keyword">select</span> &#123;</span><br><span class="line">			<span class="keyword">case</span> this.streamForks[rightNum] &lt;- philosopher: <span class="comment">//嘗試拿起右邊筷子</span></span><br><span class="line">				PickRightFork(philosopher)  <span class="comment">//成功拿起又邊筷子</span></span><br><span class="line">				Eat(philosopher)            <span class="comment">//左右邊都拿到了，開始吃</span></span><br><span class="line">				&lt;-this.streamForks[leftNum] <span class="comment">//吃完了，放下左邊筷子</span></span><br><span class="line">				PutLeftFork(philosopher)</span><br><span class="line">				&lt;-this.streamForks[rightNum] <span class="comment">//吃完了，放下右邊筷子</span></span><br><span class="line">				PutRightFork(philosopher)</span><br><span class="line">				<span class="keyword">return</span> <span class="comment">//吃飽離開</span></span><br><span class="line">			<span class="keyword">default</span>: <span class="comment">//無法拿起右邊筷子</span></span><br><span class="line">				fmt.Printf(<span class="string">&quot;Philosopher %d can&#x27;t pick fork %d.\n&quot;</span>, philosopher, rightNum)</span><br><span class="line">				&lt;-this.streamForks[leftNum] <span class="comment">//把已經拿起來的左邊筷子釋放出去</span></span><br><span class="line">				PutLeftFork(philosopher)</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">default</span>: <span class="comment">//無法拿起左邊筷子</span></span><br><span class="line">			fmt.Printf(<span class="string">&quot;Philosopher %d can&#x27;t pick fork %d.\n&quot;</span>, philosopher, leftNum)</span><br><span class="line">		&#125;</span><br><span class="line">		this.missingDoubleForkTimes++</span><br><span class="line">		Think()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>這邊對於每一隻筷子的具體表現就是一個 buffered channel，迴圈流程如下：</p>
<ol>
<li>
<p>先嘗試把自己的號碼塞入左邊的 buffered channel</p>
<ul>
<li>成功了，就是搶到一隻筷子，往下。</li>
<li>失敗了，跳到「<code>default: //無法拿起左邊筷子</code>」，思考一下，然後從頭開始。</li>
</ul>
</li>
<li>
<p>再嘗試把自己的號碼塞入右邊的 buffered channel</p>
<ul>
<li>成功了，就是搶到兩隻筷子，開始吃，吃飽離開，退出餐桌。</li>
<li>失敗了，跳到「<code>default: //無法拿起右邊筷子</code>」，把已經搶到的左邊筷子還回去，思考一下，然後從頭開始。</li>
</ul>
</li>
</ol>
<p>在 console 輸出，可以看到代表每一位哲學家的 goroutine 詳細動作過程，錯過筷子次數並不多，大部分執行結果的錯過次數在 3~5 次（點擊以下的「完整解題程式碼」就能體驗）。</p>
<h2 id="完整解題程式碼：">完整解題程式碼：</h2>
<p><a target="_blank" rel="noopener" href="https://play.golang.org/p/neTH25E8ayX">https://play.golang.org/p/neTH25E8ayX</a></p>
<h2 id="示意圖：">示意圖：</h2>
<p><img src="/content/images/leetcode/DiningPhilosophersProblem%E7%A4%BA%E6%84%8F%E5%9C%9620200902.PNG" alt=""></p>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">本文最后更新于 <span id="date-expire-num"></span> 天前，文中所描述的信息可能已发生改变</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2020-09-02");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2020-09-01T16:00:00.000Z" itemprop="datePublished">2020-09-02</time>

</p>
<p class="post-footer-info mb-0 pt-2">



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/tags/Go%E8%AA%9E%E8%A8%80/" rel="tag">#&nbsp;Go語言</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2020/09/12/%E6%88%91%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%85%AC%E7%9C%BE%E8%99%9F%E4%B8%8A%E7%9A%84%E6%96%87%E7%AB%A0%E6%B8%85%E5%96%AE_%E6%BB%BE%E5%8B%95%E6%9B%B4%E6%96%B0/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">我在微信公眾號上的文章清單(滾動更新)</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2020/06/29/%E7%9C%BE%E8%AA%AA%E7%B4%9B%E7%B4%9C%E7%9A%84%E7%94%9F%E9%95%B7%E6%BF%80%E7%B4%A0%E8%AA%BF%E6%8E%A7%E5%9B%A0%E5%AD%90/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">眾說紛紜的生長激素調控因子整理</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                        <div class="card-footer post-comment">
                            <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = 'https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://mosdeo.github.io/2020/09/01/LeetCode_Concurrency_Go%E8%AA%9E%E8%A8%80%E8%A9%B3%E8%A7%A3_%E7%B6%93%E5%85%B8%E5%93%B2%E5%AD%B8%E5%AE%B6%E5%90%83%E9%A3%AF%E5%95%8F%E9%A1%8C_%E7%A2%B0%E9%81%8B%E6%B0%A3%E8%A7%A3%E6%B3%95/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>
<script id="disqus-thread-script">
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//mosdeo-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

                        </div>
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="https://mosdeo.github.io">LKY 只有原創內容的 Blog</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};
document.getElementById('copyright-year').textContent = new Date().getFullYear();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->

    
        <script id="dsq-count-scr" src="https://mosdeo-github-io.disqus.com/count.js" async></script>

    


<!-- ### Custom Footer ### -->

    </body>

</html>